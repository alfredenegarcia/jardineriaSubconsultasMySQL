SELECT * FROM jardineria.resumen_pedidos;

-- Subconsultas
-- Con operadores básicos de comparación

-- 1.Devuelve el nombre del cliente con mayor límite de crédito.

-- 2.Devuelve el nombre del producto que tenga el precio de venta más caro.

SELECT 
    P.*
FROM
    producto P
WHERE
    P.precio_venta = (SELECT 
            MAX(precio_venta)
        FROM
            producto);

-- 3.Devuelve el nombre del producto del que se han vendido más unidades. 
-- (Tenga en cuenta que tendrá que calcular cuál es el número total de unidades que se han vendido de cada producto a partir de los datos de la tabla detalle_pedido)

SELECT 
    P.nombre, P.codigo_producto
FROM
    producto P
WHERE
    P.codigo_producto = (SELECT 
            D.codigo_producto
        FROM
            detalle_pedido D
        GROUP BY D.codigo_producto
        ORDER BY SUM(D.cantidad) DESC
        LIMIT 1);
        
-- 4.Los clientes cuyo límite de crédito sea mayor que los pagos que haya realizado. 
-- (Sin utilizar INNER JOIN).

SELECT 
    C.*
FROM
    cliente C
WHERE
    C.limite_credito > (SELECT 
            SUM(P.total)
        FROM
            pago P);